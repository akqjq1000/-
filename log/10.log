************************************************************************************
 [U-10] 불필요한 계정 제거
 [양호] 불필요한 계정이 존재하지 않는 경우
 [취약] 불필요한 계정이 존재하는 경우
************************************************************************************
[/etc/passwd 파일의 내용]
==================================================================
 
(ㄱ) 시스템 사용자인데 로그인 할 수 있는 쉘을 할당 받은 경우 점검
또한, 시스템 사용자의 정보를 자세하게 확인해야 한다.(악의적인 설정 점검)
 
(ㄴ) 일반사용자 중 최근(최근 1년간)에 로그인한 적이 없는 사용자 점검
이런경우는 lastlog 명령어의 출력 결과를 확인한다.
 
==================================================================
root:x:0:0:root:/root:/bin/bash
mrtg:x:1000:1000::/home/mrtg:/bin/bash
lejus:x:1001:1001::/home/lejus:/bin/bash
mrtg-2.17.4:x:1003:1003::/home/mrtg-2.17.4:/bin/bash
test:x:1004:1004::/home/test:/bin/bash

[lastlog 명령어의 출력내용]
==================================================================
 
(ㄱ) 최근 1년간 로그인한적이 없는 사용자를 점검한다.
(ㄴ) 이 부분은 고객과 반드시 상의해야 한다.
 
==================================================================
사용자이름       포트     어디서           최근정보
root             pts/0                     목  1월  4 20:36:04 +0900 2024
bin                                        **한번도 로그인한 적이 없습니다**
daemon                                     **한번도 로그인한 적이 없습니다**
adm                                        **한번도 로그인한 적이 없습니다**
lp                                         **한번도 로그인한 적이 없습니다**
sync                                       **한번도 로그인한 적이 없습니다**
shutdown                                   **한번도 로그인한 적이 없습니다**
halt                                       **한번도 로그인한 적이 없습니다**
mail                                       **한번도 로그인한 적이 없습니다**
operator                                   **한번도 로그인한 적이 없습니다**
games                                      **한번도 로그인한 적이 없습니다**
ftp              pts/0                     화  1월  2 10:43:10 +0900 2024
nobody                                     **한번도 로그인한 적이 없습니다**
systemd-network                            **한번도 로그인한 적이 없습니다**
dbus                                       **한번도 로그인한 적이 없습니다**
polkitd                                    **한번도 로그인한 적이 없습니다**
sshd                                       **한번도 로그인한 적이 없습니다**
postfix                                    **한번도 로그인한 적이 없습니다**
chrony                                     **한번도 로그인한 적이 없습니다**
apache                                     **한번도 로그인한 적이 없습니다**
mrtg             pts/0                     목  1월  4 20:36:04 +0900 2024
tcpdump                                    **한번도 로그인한 적이 없습니다**
saslauth                                   **한번도 로그인한 적이 없습니다**
tss                                        **한번도 로그인한 적이 없습니다**
named                                      **한번도 로그인한 적이 없습니다**
mysql                                      **한번도 로그인한 적이 없습니다**
lejus            pts/0                     목  1월  4 20:36:04 +0900 2024
mrtg-2.17.4      pts/0                     목  1월  4 20:36:04 +0900 2024
rpc                                        **한번도 로그인한 적이 없습니다**
mailnull                                   **한번도 로그인한 적이 없습니다**
smmsp                                      **한번도 로그인한 적이 없습니다**
rpcuser                                    **한번도 로그인한 적이 없습니다**
test             pts/0                     목  1월  4 20:36:04 +0900 2024
nfsnobody                                  **한번도 로그인한 적이 없습니다**

[su 명령어의 실패시도 내용]
==================================================================
 
(ㄱ) 빈번하게 su 명령어를 실행하는 사용자들 점검(하루에 20번 이상)
(ㄴ) 일반사용자에서 root 사용자로 전환하는 경우를 중점적으로 점검한다.
 
==================================================================
Dec 19 18:04:41 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 19 18:04:54 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 19 18:05:00 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 19 18:05:22 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 19 18:07:22 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 19 18:07:27 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 19 18:07:33 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 19 18:07:40 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 19 18:09:11 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 19 18:09:26 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 19 18:09:32 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 19 18:09:43 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 20 09:57:40 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 20 09:58:18 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 20 09:58:28 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
Dec 20 09:59:08 mrtg su: pam_unix(su-l:auth): authentication failure; logname=lejus uid=1001 euid=0 tty=pts/1 ruser=lejus rhost=  user=root
